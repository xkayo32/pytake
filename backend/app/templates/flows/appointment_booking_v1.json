{
  "id": "appointment_booking_v1",
  "name": "Agendamento de Consultas",
  "description": "Sistema completo de agendamento com verifica√ß√£o de disponibilidade, sele√ß√£o de hor√°rio e confirma√ß√£o autom√°tica",
  "category": "scheduling",
  "subcategory": "appointments",
  "thumbnail_url": "/templates/thumbnails/scheduling.png",
  "preview_image_url": "/templates/previews/scheduling_flow.png",
  "tags": ["agendamento", "consultas", "calend√°rio", "hor√°rios"],
  "complexity": "simple",
  "estimated_setup_time": "4 minutos",
  "node_count": 10,
  "features": [
    "Sele√ß√£o de servi√ßo",
    "Verifica√ß√£o de disponibilidade em tempo real",
    "Escolha de data e hor√°rio",
    "Confirma√ß√£o de dados",
    "Integra√ß√£o com calend√°rio",
    "Envio de confirma√ß√£o por email",
    "Lembretes autom√°ticos"
  ],
  "variables_used": [
    "customer_name",
    "customer_phone",
    "customer_email",
    "service_type",
    "appointment_date",
    "appointment_time",
    "appointment_id",
    "professional_name"
  ],
  "requires_integrations": ["api_calendar"],
  "metadata": {
    "language": "pt-BR",
    "use_count": 0,
    "rating": 0.0,
    "created_at": "2025-01-15",
    "version": "1.0"
  },
  "flow_data": {
    "name": "Agendamento de Consultas",
    "description": "Flow para agendamento automatizado de consultas",
    "is_main": false,
    "canvas_data": {
      "nodes": [
        {
          "id": "node_1",
          "type": "start",
          "position": {"x": 250, "y": 50},
          "data": {
            "label": "In√≠cio"
          }
        },
        {
          "id": "node_2",
          "type": "message",
          "position": {"x": 250, "y": 150},
          "data": {
            "label": "Boas-vindas",
            "content": {
              "text": "üìÖ *Agendamento Online*\n\nOl√°! Vou te ajudar a agendar sua consulta de forma r√°pida e f√°cil.\n\nVamos come√ßar? üòä"
            }
          }
        },
        {
          "id": "node_3",
          "type": "question",
          "position": {"x": 250, "y": 270},
          "data": {
            "label": "Nome do Cliente",
            "question": "Qual √© o seu nome completo?",
            "variable": "customer_name",
            "validation": {
              "type": "text",
              "min_length": 3,
              "max_length": 100
            }
          }
        },
        {
          "id": "node_4",
          "type": "question",
          "position": {"x": 250, "y": 390},
          "data": {
            "label": "Telefone",
            "question": "Qual o seu telefone para contato?",
            "variable": "customer_phone",
            "validation": {
              "type": "phone"
            }
          }
        },
        {
          "id": "node_5",
          "type": "question",
          "position": {"x": 250, "y": 510},
          "data": {
            "label": "Email",
            "question": "E seu email? (Enviaremos a confirma√ß√£o)",
            "variable": "customer_email",
            "validation": {
              "type": "email"
            }
          }
        },
        {
          "id": "node_6",
          "type": "question",
          "position": {"x": 250, "y": 630},
          "data": {
            "label": "Tipo de Servi√ßo",
            "question": "Que tipo de consulta voc√™ precisa?",
            "variable": "service_type",
            "options": [
              "üë®‚Äç‚öïÔ∏è Consulta Geral",
              "ü¶∑ Odontologia",
              "üëÅÔ∏è Oftalmologia",
              "üß† Psicologia",
              "üíÜ Fisioterapia"
            ]
          }
        },
        {
          "id": "node_7",
          "type": "api_call",
          "position": {"x": 250, "y": 750},
          "data": {
            "label": "Verificar Disponibilidade",
            "url": "{{API_URL}}/calendar/availability",
            "method": "GET",
            "headers": {
              "Authorization": "Bearer {{API_TOKEN}}"
            },
            "query_params": {
              "service": "{{service_type}}",
              "days": 7
            },
            "output_variable": "available_slots"
          }
        },
        {
          "id": "node_8",
          "type": "message",
          "position": {"x": 250, "y": 870},
          "data": {
            "label": "Exibir Disponibilidade",
            "content": {
              "text": "üìÜ *Hor√°rios Dispon√≠veis:*\n\n{{#each available_slots}}\n{{index}}. {{date}} √†s {{time}} - {{professional}}\n{{/each}}\n\nDigite o n√∫mero do hor√°rio desejado:"
            }
          }
        },
        {
          "id": "node_9",
          "type": "question",
          "position": {"x": 250, "y": 990},
          "data": {
            "label": "Selecionar Hor√°rio",
            "question": "Qual hor√°rio voc√™ prefere?",
            "variable": "selected_slot",
            "validation": {
              "type": "number",
              "min": 1
            }
          }
        },
        {
          "id": "node_10",
          "type": "action",
          "position": {"x": 250, "y": 1110},
          "data": {
            "label": "Extrair Detalhes",
            "action_type": "script",
            "script": "// Extrair detalhes do hor√°rio selecionado\nconst slot = available_slots[selected_slot - 1];\n\nreturn {\n  appointment_date: slot.date,\n  appointment_time: slot.time,\n  professional_name: slot.professional\n};",
            "output_variable": "appointment_details"
          }
        },
        {
          "id": "node_11",
          "type": "message",
          "position": {"x": 250, "y": 1230},
          "data": {
            "label": "Confirmar Dados",
            "content": {
              "text": "‚úÖ *Confirme seus dados:*\n\nüë§ Nome: {{customer_name}}\nüìû Telefone: {{customer_phone}}\nüìß Email: {{customer_email}}\n\nüè• Servi√ßo: {{service_type}}\nüìÖ Data: {{appointment_date}}\n‚è∞ Hor√°rio: {{appointment_time}}\nüë®‚Äç‚öïÔ∏è Profissional: {{professional_name}}\n\nEst√° tudo correto?"
            }
          }
        },
        {
          "id": "node_12",
          "type": "question",
          "position": {"x": 250, "y": 1350},
          "data": {
            "label": "Confirma√ß√£o",
            "question": "Digite *SIM* para confirmar ou *N√ÉO* para cancelar:",
            "variable": "confirmation",
            "options": ["SIM", "N√ÉO"]
          }
        },
        {
          "id": "node_13",
          "type": "condition",
          "position": {"x": 250, "y": 1470},
          "data": {
            "label": "Confirmado?",
            "conditions": [
              {
                "variable": "confirmation",
                "operator": "==",
                "value": "SIM",
                "branch": "confirmed"
              },
              {
                "variable": "confirmation",
                "operator": "==",
                "value": "N√ÉO",
                "branch": "cancelled"
              }
            ]
          }
        },
        {
          "id": "node_14",
          "type": "api_call",
          "position": {"x": 100, "y": 1610},
          "data": {
            "label": "Criar Agendamento",
            "url": "{{API_URL}}/calendar/appointments",
            "method": "POST",
            "headers": {
              "Authorization": "Bearer {{API_TOKEN}}",
              "Content-Type": "application/json"
            },
            "body": {
              "customer_name": "{{customer_name}}",
              "customer_phone": "{{customer_phone}}",
              "customer_email": "{{customer_email}}",
              "service_type": "{{service_type}}",
              "date": "{{appointment_date}}",
              "time": "{{appointment_time}}",
              "professional": "{{professional_name}}"
            },
            "output_variable": "booking_response"
          }
        },
        {
          "id": "node_15",
          "type": "action",
          "position": {"x": 100, "y": 1730},
          "data": {
            "label": "Enviar Email Confirma√ß√£o",
            "action_type": "send_email",
            "email_data": {
              "to": "{{customer_email}}",
              "subject": "Confirma√ß√£o de Agendamento - {{appointment_date}}",
              "template": "appointment_confirmation",
              "variables": {
                "customer_name": "{{customer_name}}",
                "service_type": "{{service_type}}",
                "appointment_date": "{{appointment_date}}",
                "appointment_time": "{{appointment_time}}",
                "professional_name": "{{professional_name}}",
                "appointment_id": "{{booking_response.id}}"
              }
            }
          }
        },
        {
          "id": "node_16",
          "type": "message",
          "position": {"x": 100, "y": 1850},
          "data": {
            "label": "Sucesso",
            "content": {
              "text": "‚úÖ *Agendamento Confirmado!*\n\nüìã Protocolo: #{{booking_response.id}}\n\nüìÖ {{appointment_date}} √†s {{appointment_time}}\nüë®‚Äç‚öïÔ∏è Com {{professional_name}}\n\nüìß Enviamos uma confirma√ß√£o para {{customer_email}}\n\n‚è∞ Voc√™ receber√° um lembrete 24h antes da consulta.\n\nAt√© breve! üòä"
            }
          }
        },
        {
          "id": "node_17",
          "type": "message",
          "position": {"x": 400, "y": 1610},
          "data": {
            "label": "Cancelado",
            "content": {
              "text": "‚ùå Agendamento cancelado.\n\nSe precisar, pode iniciar um novo agendamento a qualquer momento.\n\nEstamos √† disposi√ß√£o! üòä"
            }
          }
        },
        {
          "id": "node_18",
          "type": "end",
          "position": {"x": 250, "y": 1990},
          "data": {
            "label": "Fim"
          }
        }
      ],
      "edges": [
        {"id": "edge_1", "source": "node_1", "target": "node_2"},
        {"id": "edge_2", "source": "node_2", "target": "node_3"},
        {"id": "edge_3", "source": "node_3", "target": "node_4"},
        {"id": "edge_4", "source": "node_4", "target": "node_5"},
        {"id": "edge_5", "source": "node_5", "target": "node_6"},
        {"id": "edge_6", "source": "node_6", "target": "node_7"},
        {"id": "edge_7", "source": "node_7", "target": "node_8"},
        {"id": "edge_8", "source": "node_8", "target": "node_9"},
        {"id": "edge_9", "source": "node_9", "target": "node_10"},
        {"id": "edge_10", "source": "node_10", "target": "node_11"},
        {"id": "edge_11", "source": "node_11", "target": "node_12"},
        {"id": "edge_12", "source": "node_12", "target": "node_13"},
        {"id": "edge_13", "source": "node_13", "target": "node_14", "sourceHandle": "confirmed"},
        {"id": "edge_14", "source": "node_14", "target": "node_15"},
        {"id": "edge_15", "source": "node_15", "target": "node_16"},
        {"id": "edge_16", "source": "node_16", "target": "node_18"},
        {"id": "edge_17", "source": "node_13", "target": "node_17", "sourceHandle": "cancelled"},
        {"id": "edge_18", "source": "node_17", "target": "node_18"}
      ]
    }
  }
}
