{
  "id": "ecommerce_product_catalog_v1",
  "name": "Catálogo de Produtos E-commerce",
  "description": "Apresenta catálogo de produtos, permite busca por categoria, exibe detalhes e processa pedidos via WhatsApp",
  "category": "sales_ecommerce",
  "subcategory": "catalog",
  "thumbnail_url": "/templates/thumbnails/ecommerce.png",
  "preview_image_url": "/templates/previews/ecommerce_flow.png",
  "tags": ["e-commerce", "catálogo", "vendas", "produtos", "pedidos"],
  "complexity": "medium",
  "estimated_setup_time": "7 minutos",
  "node_count": 11,
  "features": [
    "Menu interativo de categorias",
    "Busca de produtos por categoria",
    "Exibição de detalhes e preços",
    "Adição ao carrinho",
    "Confirmação de pedido",
    "Coleta de endereço de entrega",
    "Integração com sistema de pedidos"
  ],
  "variables_used": [
    "customer_name",
    "selected_category",
    "selected_product",
    "quantity",
    "delivery_address",
    "payment_method",
    "cart_items",
    "order_total"
  ],
  "requires_integrations": ["api_products", "api_orders"],
  "metadata": {
    "language": "pt-BR",
    "use_count": 0,
    "rating": 0.0,
    "created_at": "2025-01-15",
    "version": "1.0"
  },
  "flow_data": {
    "name": "Catálogo de Produtos E-commerce",
    "description": "Flow para apresentar produtos e processar pedidos",
    "is_main": false,
    "canvas_data": {
      "nodes": [
        {
          "id": "node_1",
          "type": "start",
          "position": {"x": 250, "y": 50},
          "data": {
            "label": "Início"
          }
        },
        {
          "id": "node_2",
          "type": "message",
          "position": {"x": 250, "y": 150},
          "data": {
            "label": "Boas-vindas",
            "content": {
              "text": "🛒 *Bem-vindo à Loja Online!*\n\nConfira nossos produtos e faça seu pedido diretamente pelo WhatsApp.\n\nTemos entrega rápida e pagamento facilitado! 🚀"
            }
          }
        },
        {
          "id": "node_3",
          "type": "question",
          "position": {"x": 250, "y": 270},
          "data": {
            "label": "Menu de Categorias",
            "question": "Escolha uma categoria para ver nossos produtos:",
            "variable": "selected_category",
            "options": [
              "📱 Eletrônicos",
              "👕 Roupas",
              "🏠 Casa e Decoração",
              "⚽ Esportes",
              "📚 Livros"
            ]
          }
        },
        {
          "id": "node_4",
          "type": "api_call",
          "position": {"x": 250, "y": 390},
          "data": {
            "label": "Buscar Produtos",
            "url": "{{API_URL}}/products",
            "method": "GET",
            "headers": {
              "Authorization": "Bearer {{API_TOKEN}}"
            },
            "query_params": {
              "category": "{{selected_category}}"
            },
            "output_variable": "products_list"
          }
        },
        {
          "id": "node_5",
          "type": "message",
          "position": {"x": 250, "y": 510},
          "data": {
            "label": "Exibir Produtos",
            "content": {
              "text": "📦 *Produtos em {{selected_category}}:*\n\n{{#each products_list}}\n{{index}}. {{name}}\n💰 R$ {{price}}\n{{description}}\n\n{{/each}}\nDigite o número do produto para ver mais detalhes ou *0* para voltar ao menu."
            }
          }
        },
        {
          "id": "node_6",
          "type": "question",
          "position": {"x": 250, "y": 630},
          "data": {
            "label": "Selecionar Produto",
            "question": "Qual produto você deseja?",
            "variable": "selected_product",
            "validation": {
              "type": "number"
            }
          }
        },
        {
          "id": "node_7",
          "type": "condition",
          "position": {"x": 250, "y": 750},
          "data": {
            "label": "Voltar ao Menu?",
            "conditions": [
              {
                "variable": "selected_product",
                "operator": "==",
                "value": "0",
                "branch": "back"
              },
              {
                "variable": "selected_product",
                "operator": ">",
                "value": "0",
                "branch": "continue"
              }
            ]
          }
        },
        {
          "id": "node_8",
          "type": "question",
          "position": {"x": 400, "y": 870},
          "data": {
            "label": "Quantidade",
            "question": "Quantas unidades você deseja?",
            "variable": "quantity",
            "validation": {
              "type": "number",
              "min": 1,
              "max": 99
            }
          }
        },
        {
          "id": "node_9",
          "type": "action",
          "position": {"x": 400, "y": 990},
          "data": {
            "label": "Adicionar ao Carrinho",
            "action_type": "script",
            "script": "// Adicionar produto ao carrinho\nif (!cart_items) cart_items = [];\n\nconst product = products_list[selected_product - 1];\ncart_items.push({\n  product_id: product.id,\n  name: product.name,\n  price: product.price,\n  quantity: quantity\n});\n\nreturn {cart_items};",
            "output_variable": "cart_items"
          }
        },
        {
          "id": "node_10",
          "type": "message",
          "position": {"x": 400, "y": 1110},
          "data": {
            "label": "Confirmação",
            "content": {
              "text": "✅ Produto adicionado ao carrinho!\n\n*Deseja:*\n1️⃣ Ver mais produtos\n2️⃣ Finalizar pedido"
            }
          }
        },
        {
          "id": "node_11",
          "type": "question",
          "position": {"x": 400, "y": 1230},
          "data": {
            "label": "Continuar ou Finalizar",
            "question": "Digite 1 ou 2:",
            "variable": "next_action",
            "options": ["1", "2"]
          }
        },
        {
          "id": "node_12",
          "type": "condition",
          "position": {"x": 400, "y": 1350},
          "data": {
            "label": "Ação",
            "conditions": [
              {
                "variable": "next_action",
                "operator": "==",
                "value": "1",
                "branch": "continue_shopping"
              },
              {
                "variable": "next_action",
                "operator": "==",
                "value": "2",
                "branch": "checkout"
              }
            ]
          }
        },
        {
          "id": "node_13",
          "type": "action",
          "position": {"x": 550, "y": 1490},
          "data": {
            "label": "Calcular Total",
            "action_type": "script",
            "script": "// Calcular total do carrinho\nlet total = 0;\ncart_items.forEach(item => {\n  total += item.price * item.quantity;\n});\n\nreturn {order_total: total.toFixed(2)};",
            "output_variable": "order_total"
          }
        },
        {
          "id": "node_14",
          "type": "message",
          "position": {"x": 550, "y": 1610},
          "data": {
            "label": "Resumo do Pedido",
            "content": {
              "text": "🛒 *Resumo do Pedido:*\n\n{{#each cart_items}}\n• {{quantity}}x {{name}} - R$ {{price}}\n{{/each}}\n\n💰 *Total: R$ {{order_total}}*"
            }
          }
        },
        {
          "id": "node_15",
          "type": "question",
          "position": {"x": 550, "y": 1730},
          "data": {
            "label": "Endereço de Entrega",
            "question": "Por favor, informe seu endereço completo para entrega:",
            "variable": "delivery_address",
            "validation": {
              "type": "text",
              "min_length": 10
            }
          }
        },
        {
          "id": "node_16",
          "type": "question",
          "position": {"x": 550, "y": 1850},
          "data": {
            "label": "Forma de Pagamento",
            "question": "Escolha a forma de pagamento:",
            "variable": "payment_method",
            "options": [
              "💳 Cartão de Crédito",
              "💵 Dinheiro",
              "🔲 PIX"
            ]
          }
        },
        {
          "id": "node_17",
          "type": "api_call",
          "position": {"x": 550, "y": 1970},
          "data": {
            "label": "Criar Pedido",
            "url": "{{API_URL}}/orders",
            "method": "POST",
            "headers": {
              "Authorization": "Bearer {{API_TOKEN}}",
              "Content-Type": "application/json"
            },
            "body": {
              "customer_name": "{{customer_name}}",
              "items": "{{cart_items}}",
              "total": "{{order_total}}",
              "delivery_address": "{{delivery_address}}",
              "payment_method": "{{payment_method}}"
            },
            "output_variable": "order_response"
          }
        },
        {
          "id": "node_18",
          "type": "message",
          "position": {"x": 550, "y": 2090},
          "data": {
            "label": "Confirmação Final",
            "content": {
              "text": "✅ *Pedido Confirmado!*\n\n📋 Número do pedido: #{{order_response.order_id}}\n\n🚚 Previsão de entrega: {{order_response.delivery_estimate}}\n\nObrigado pela preferência! 😊"
            }
          }
        },
        {
          "id": "node_19",
          "type": "end",
          "position": {"x": 400, "y": 2220},
          "data": {
            "label": "Fim"
          }
        }
      ],
      "edges": [
        {"id": "edge_1", "source": "node_1", "target": "node_2"},
        {"id": "edge_2", "source": "node_2", "target": "node_3"},
        {"id": "edge_3", "source": "node_3", "target": "node_4"},
        {"id": "edge_4", "source": "node_4", "target": "node_5"},
        {"id": "edge_5", "source": "node_5", "target": "node_6"},
        {"id": "edge_6", "source": "node_6", "target": "node_7"},
        {"id": "edge_7", "source": "node_7", "target": "node_3", "sourceHandle": "back"},
        {"id": "edge_8", "source": "node_7", "target": "node_8", "sourceHandle": "continue"},
        {"id": "edge_9", "source": "node_8", "target": "node_9"},
        {"id": "edge_10", "source": "node_9", "target": "node_10"},
        {"id": "edge_11", "source": "node_10", "target": "node_11"},
        {"id": "edge_12", "source": "node_11", "target": "node_12"},
        {"id": "edge_13", "source": "node_12", "target": "node_3", "sourceHandle": "continue_shopping"},
        {"id": "edge_14", "source": "node_12", "target": "node_13", "sourceHandle": "checkout"},
        {"id": "edge_15", "source": "node_13", "target": "node_14"},
        {"id": "edge_16", "source": "node_14", "target": "node_15"},
        {"id": "edge_17", "source": "node_15", "target": "node_16"},
        {"id": "edge_18", "source": "node_16", "target": "node_17"},
        {"id": "edge_19", "source": "node_17", "target": "node_18"},
        {"id": "edge_20", "source": "node_18", "target": "node_19"}
      ]
    }
  }
}
